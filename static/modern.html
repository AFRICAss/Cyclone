<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cyclone</title>
    <meta name="theme-color" content="#03ff65">
    <meta name="description" content="Home of Cyclone with &#10084; from Nebula">
    <meta property="og:image" content="cyclone2.png">
    <link rel="shortcut icon" href="cyclone2.png" type="image/x-icon">
    <link rel="stylesheet" href="style.css">
    <script src="/nogg.js"></script>
    <script>
        // Will be used soon
        const xor = {
            encode: (url) => encodeURIComponent(url.toString().split("").map((char, ind) => ind % 2 ? String
                .fromCharCode(char.charCodeAt() ^ 2) : char).join("")),
            decode: (url) => decodeURIComponent(url.split("?")[0]).split("").map((char, ind) => ind % 2 ? String
                .fromCharCode(char.charCodeAt(0) ^ 2) : char).join("") + (url.split("?").slice(1).length ? "?" +
                url.split("?").slice(1).join("?") : "")
        }

        function isValidURL(str) {
            var regexp =
                /^(?:(?:https?|ftp):\/\/)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/\S*)?$/;
            if (regexp.test(str)) {
                return true;
            } else {
                return false;
            }
        }
        
        function go() {
            var input = document.querySelector('input');

            if (input.value) {
                var url = input.value;
                if (!isValidURL(url)) {
                    url = 'https://google.com/search?q=' + url;
                }

                var iframe = document.querySelector('iframe');
                iframe.src = '/service/'+url

            } else {
                alert('Please provide a link. It does not require https://.');
            }
        }
    </script>
</head>

<body>
    <div class="nav">
        <img src="cyclone2.png" class="logo" onclick="location.reload(); document.querySelector('iframe').src = 'home.html'">
        <div class="wrap">
            <a class="btnREF" onclick="location.reload();">
                <svg xmlns="http://www.w3.org/2000/svg" class="refresh" viewBox="0 0 24 24" stroke-width="2" stroke="#3163b3" fill="none" stroke-linecap="round" stroke-linejoin="round">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                    <path d="M4.05 11a8 8 0 1 1 .5 4m-.5 5v-5h5" />
                </svg>
            </a>
            <input type="url" class="url" placeholder="snazzy link">
        </div>
    </div>
    <main>
        <iframe src="home.html" frameborder="0"></iframe>
    </main>
    <script>
        document.querySelectorAll(".url").forEach(a=>{
          a.addEventListener("keydown", (event) => {
            if (event.key === 'Enter') go();
          });
        })
    </script>
</body>

</html>
